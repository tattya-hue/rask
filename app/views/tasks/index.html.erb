<div class="d-flex align-items-center">
  <%= render 'layouts/h1', title: "タスク一覧" %>
  <div class="flex-grow-1"></div>

  <div class="border p-3 my-3 rounded d-flex gap-3">
    <table class="table mb-0">
      <thead>
        <tr>
          <th>ソート：</th>
          <th><%= sort_link(@q, :updated_at, "更新順", class: "link-primary") %></th>
          <th><%= sort_link(@q, :created_at, "作成順", class: "link-primary") %></th>
          <th><%= sort_link(@q, :due_at, "期限順", class: "link-primary") %></th>
          <th><%= sort_link(@q, :project_id, "プロジェクト名順", class: "link-primary") %></th>
        </tr>
      </thead>
    </table>
  </div>

  <div class="border p-3 my-3 rounded d-flex align-items-center gap-3">
    <%= search_form_for @q, class: "d-flex align-items-center w-100" do |f| %>
      <%= f.text_field :content_or_assigner_screen_name_or_description_or_project_name_cont, 
        class: "form-control me-2", 
        placeholder: '検索ワードを入力して下さい', 
        style: "flex: 1;" %>
      <%= hidden_field_tag :only_todo, params[:only_todo] if params[:only_todo].present? %>
      <%= f.submit "検索", class: "btn btn-primary" %>
    <% end %>
  </div>

  <%= link_to '新規作成', new_task_path, class: "btn btn-danger ms-3" %>
</div>

<%= form_with url: request.path, method: :get, local: true, html: { class: "d-flex" } do %>
  <%= check_box_tag :only_todo, "1", params[:only_todo] == "1", onchange: "this.form.submit()" %>
  <div class="mx-1">
    todoのみ
  </div>

  <% if params[:q].present? %>
    <% params[:q].each do |key, value| %>
      <%= hidden_field_tag "q[#{key}]", value %>
    <% end %>
  <% end %>
<% end %>

<ul class="text-center nav nav-tabs" id="myTab" role="tablist">
  <li class="nav-item w-50 bg-light">
    <a class="nav-link active link-text" id="my-tasks-tab" data-toggle="tab" href="#my-tasks" role="tab" aria-controls="my-tasks" aria-selected="true"><%= current_user&.screen_name %>のタスク</a>
  </li>
  <li class="nav-item w-50 bg-light">
    <a class="nav-link link-text" id="all-tasks-tab" data-toggle="tab" href="#all-tasks" role="tab" aria-controls="all-tasks" aria-selected="false">すべてのタスク</a>
  </li>
</ul>

<div class="tab-content" id="myTabContent">
  <div class="tab-pane fade show active" id="my-tasks" role="tabpanel" aria-labelledby="my-tasks-tab">
    <%= turbo_frame_tag "my-tasks" do %>
      <%= render @mytasks %>
      <div class="row">
        <div class="col-md-12 col-sm-12 text-center hidden-xs">
          <%= raw(paginate @mytasks) %>
        </div>
      </div>
    <% end %>
  </div>
  <div class="mb-5 tab-pane fade" id="all-tasks" role="tabpanel" aria-labelledby="all-tasks-tab">
    <%= turbo_frame_tag "all-tasks" do %>
      <%= render @tasks %>
      <div class="row">
        <div class="col-md-12 col-sm-12 text-center hidden-xs">
          <%= raw(paginate @tasks) %>
        </div>
      </div>
    <% end %>
  </div>
</div>

<style>
  .text-black {
    text-decoration: none;
  }
</style>
